{% extends 'base.html.twig' %}

{% block title %}Рубрики{% endblock %}

{% block body %}
    <h1>Рубрики</h1>
        <table class="table">
            <tbody>
                <tr>
                    <td>


                        {% import _self as macros %}
                        {% macro category_list(category) %}
                            {% import _self as macros %}
                            <ul>
                                <li class="list-group-item rounded border border-light">
                                    <div class="row">
                                        <div class="col-sm-1"></div>
                                        <div class="col-sm-9">
                                            <a class="" href="{{ path('category.show', {'id': category.id}) }}">{{ category.name }}</a>
                                        </div>
                                        <div class="col-sm-1">
                                            {% if app.user and app.user.isAdmin %}
                                                <a class="btn btn-success" href="{{ path('category.edit', {'id': category.id}) }}">Edit</a>
                                            {% endif %}
                                        </div>
                                        <div class="col-sm-1">
                                            <span class="badge badge-pill badge-primary">{{ category.companiesCounter }}</span>
                                        </div>
                                    </div>
                                    {% if category.childrenCategories %}
                                        {% for children in category.childrenCategories %}
                                            {{ macros.category_list(children) }}
                                        {% endfor %}
                                    {% endif %}
                                </li>
                            </ul>
                        {% endmacro %}


                        <ul>
                        {% for category in categories %}
                            {% if category.level == 0 %}
                            <li class="list-group-item rounded ">
                                <div class="row">
                                    <div class="col-sm-1"></div>
                                    <div class="col-sm-9">
                                        <a class="" href="{{ path('category.show', {'id': category.id}) }}">{{ category.name }}</a>
                                    </div>
                                    <div class="col-sm-1">
                                        {% if app.user and app.user.isAdmin %}
                                            <a class="btn btn-success" href="{{ path('category.edit', {'id': category.id}) }}">Edit</a>
                                        {% endif %}
                                    </div>
                                    <div class="col-sm-1">
                                        <span class="badge badge-pill badge-primary">{{ category.companiesCounter }}</span>
                                    </div>
                                </div>
                                {% if category.childrenCategories %}
                                    {% for children in category.childrenCategories %}
                                        {{ macros.category_list(children) }}
                                    {% endfor %}
                                {% endif %}
                            </li>
                            {% endif %}
                        {% endfor %}
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <ul>
    {% if app.user and app.user.isAdmin %}
        <a class="btn btn-primary" href="{{ path('category.new') }}">Создать категорию</a>
    {% endif %}
{% endblock %}